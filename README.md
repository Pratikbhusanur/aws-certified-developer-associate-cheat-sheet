# AWS DVA-C01 Cheat-sheet

## AWS S3

- Logging (server across logging) into the same bucket causes exponential log growth.
- **CloudFront Distributions** to reduce latency of websites to users
- **Encryptions** :
  - Amazon S3-Managed Keys **(SSE-S3)** : the data is encrypted by Amazon S3 using keys that are managed through S3
  - Server-Side Encryption with Customer-Provided Keys **(SSE-C)** : you manage the encryption keys and Amazon S3 manages the encryption
  - Server-Side Encryption with Customer Master Keys **(CMKs)** Stored in AWS Key Management Service **(SSE-KMS) :** auditing and permissions , control
  - Server side encryption with **AWS KMS (SSE-KMS) throttles S3 performance** because **AWS KMS API calls has quota limit**
- Access S3 privately (rather than across the Internet) - Configure a hardware VPN to a VPC and configure an S3 endpoint
- **Glacier data retrieval options**
  - **Standard retrievals** : **3–5 hours**. This is default option.
  - **Bulk retrievals: 5–12 hours** , **lowest-cost** , can large or **petabytes** of data retrieval
  - **Expedited: 1–5 minutes** , **higher-cost**

## CloudFront

- Lambda@Edge runs your code in response to events generated by the Amazon CloudFront
- use Lambda@Edge to help authenticate and authorize users for the premium pay-wall content on your website, filtering out unauthorized requests before they reach your origin infrastructure
- **HTTP 504 errors** , lot t of time to log into their website
  - Use Lambda@Edge
  - set up an **origin failover** by creating an origin group with two origins primary origin and second origin, which CloudFront **automatically switches to when the primary origin fails**

## VPC

- **VPC Flow Logs**
  - capture information about the **IP traffic going to and from in your VPC**

## IAM ROLE

- Using IAM Role for EC2, ASG is more secure than providing access via IAM user
- **ECS tasks can also be assigned with IAM ROLES** just like IAM Role or EC2 instances
- Want EC2 instance to access other AWS services use IAM ROLE
- **Cross Account access:**
  - your developers/Ops want to access particular resources in 2 or more different (PROD , TEST) AWS accounts
  - temporary access to resources in a second account (use with STS)

## Application Load Balancer

- Sticky sessions, ( session affinity ) maintain state information , helps to prevent re-authentication
- Target type
  - **Instance** : The targets are specified by instance ID.
  - **IP** : The targets are IP addresses.
  - **Lambda** : The target is a Lambda function.

## CLI

- CLI precedence
  1. **Command line**
  2. **Environment variables**
  3. **CLI credentials file (.aws/config)**
  4. **Container credentials**
  5. **Instance profile credentials**

- [https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-quickstart.html#cli-configure-quickstart-precedence](https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-quickstart.html#cli-configure-quickstart-precedence)

## CloudFormation

- **Parameters**
  - It&#39;s like variables declaration, contains values to pass to your template at runtime
- **Mappings**
  - set values based on a region
  - use the _ **Fn::FindInMap** _ intrinsic function to retrieve values in a map
- **Resources**
  - This is the **ONLY mandatory field**
  - AWS resources that you want to include in the stack, Ex: EC2 instance or S3 bucket.
- **Outputs**
  - utput values that you can import into other stacks
  - view on the AWS CloudFormation console.

## SAM - Serverless Application Module

- **Serverless** Application deployments,
- **templatized** serverless application
- The declaration  **Transform** : AWS::Serverless-2016-10-31 is **required** for AWS SAM template files, **Transform** is what identifies it as AWS SAM template instead of CloudFormation template
  - Others include , Globals, Resources, and Parameters
- **sam package, sam deploy** serverless application
- **CloudFormation package , then CloudFormation deploy**
- **SAM** is extension to CloudFormation , more simpler.
- **Rolls back** the deployment if CloudWatch alarms are triggered
- Deployment Preference Type
  - **Canary** – 2 Increments ( ex: 10% and 90% or 35% and 65%)
  - **Linear** - equal increments , equal min
  - **All-at-once –** All at once.
- **AWS::Serverless::Application**  : Define a **Nested application**
- **AWS::Serverless::Function** : C **reating a Lambda function**
- **AWS::Serverless::LayerVersion** : C **reating a Lambda layers**
- **AWS::Serverless::Api** : Describes an **API Gateway resource**
- **AWS::Serverless::HttpApi** : Creates an Amazon **API Gateway HTTP API**
- **AWS::Serverless::StateMachine** : Creates AWS **Step Functions state machine**
-
- [https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-specification-resources-and-properties.html](https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-specification-resources-and-properties.html)
- Has its own cli (different from aws cli)

## Lambda

- To **increase performance keep connect or close statements outside of the handler** , Place the connection in the global space or have login in program to check db connectivity before making connections
- Lambda **needs permission to be granted to write to CloudWatch logs** , if no permission then nothing will be written to CloudWatch logs
- **Aliases**
  - Pointer to a specific **Lambda function version**
- **Layers**
  - A layer is just a ZIP archive that contains libraries, a custom runtime, or other dependencies
  - used to pull in additional code and content in the form of layers
- **Environment variables**
  - Enable you to dynamically pass settings to your function code and libraries, without making changes to your code
  - Ex: Lambda function which will run in various environments such **as DEV, TEST, UAT, and PROD** , and call different API for different environments
- **Synchronous invocation**
  - **Wait for the function to process the event and return a response**

- **Asynchronous invocation**
  - Lambda **queues the event for processing** and **returns a response immediately** and without additional information **(StatusCode: 202)**
  - use the _ **invoke** _command with **--invocation-type** parameter to **Event**
- HTTP **Status Code: 429 ( or 502)**: _ **TooManyRequestsException** _ ,
  - The request **throughput limit was exceeded**  **for Synchronous invocations**.
  - Asynchronous invocation  retry, then to DLQ (Dead letter Queue)
- HTTP **Status Code 504** (5XX)
  - INTEGRATION\_FAILURE, INTEGRATION\_TIMEOUT
  - INTEGRATION\_TIMEOUT range is **50 milliseconds to 29 seconds**
- _ **InvalidParameterValueException** _
  - one of the parameters in the request is invalid, ex: if you provided an IAM role in the _CreateFunction_ API which AWS Lambda is **unable to assume IAM role**
  - Unzipped package is bigger than allotted size
- _ **CodeStorageExceededException** _
  - exceeded your maximum total code size per account
- _ **ResourceConflictException** _
  - resource already exists
- _ **ServiceException** _
  - AWS Lambda service encountered an internal error
- You **CANNOT**** configure an event-source mapping between and ALB and a Lambda function ,** instead use ALB target type as lambda
- Configuration Elements – check what does each do ?

### Lambda Limits

| **Resource** | **Quota** |
| --- | --- |
| Function memory allocation | 128 MB to 10,240 MB, in 1-MB increments. |
| Function timeout | 900 seconds (15 minutes) |
| Function environment variables | 4 KB |
| Function resource-based policy | 20 KB |
| Function layers | 5 layers |
| Function burst concurrency | 500 - **3000** (varies per Region) |
| Deployment package (.zip file archive) size | 50 MB (zipped, for direct upload)
 250 MB (unzipped, including layers)
 3 MB (console editor) |
| Container image code package size | 10 GB |

- **Session data** and Lambda
  - AWS Lambda is a stateless compute service and so you cannot store session data in AWS Lambda itself
  - You can use **DynamoDB or AWS S3** with lambda to store some session data (user data)
- **Concurrency** : is the number of requests that your function is serving at any given time
  - **Concurrency = number of requests \* number of executions per sec.**
  - Ex: if we have 20 requests and each requests takes 20 sec to execute then concurrency = 20\*20=400
- **Exponential backoff**
  - Helps to Lambda to retry by Increasing the wait time between retries for consecutive error responses

## Step Functions

- Series of steps that make up a workflow
- **Combine Lambda** , or **branching**** Lambda **or** parallel **processing or** Error handling**

![](RackMultipart20210625-4-1w6fu06_html_f95860abd88605c8.png) ![](RackMultipart20210625-4-1w6fu06_html_b1beb7ee27eb3d43.png) ![](RackMultipart20210625-4-1w6fu06_html_9dce2b0f9ec11d91.png) ![](RackMultipart20210625-4-1w6fu06_html_62c40b64ebf6b104.png)

- **State machine** (workflow) and tasks

## SQS

- AdjustReceiveMessage  parameter if consumer is not able to process incoming messages , ex: setReceiveMessage to 10 to retrieve 10 messages at a time
- **Short Polling :**
  - Default SQS behavior , Get msg  send msg (returns immediately) ,
  - Responds even if no msgs in queue. Empty responses possibility is more
  - WaitTimeSeconds =0 or [ReceiveMessageWaitTimeSeconds](https://docs.aws.amazon.com/AWSSimpleQueueService/latest/APIReference/API_SetQueueAttributes.html) = 0
- **Long Polling :**
  - Wait till some msgs arrive (orReceiveMessageWaitTimeSeconds reaches) in queue then send msg
  - Responds only when at least one msg is in queue , sends an empty response only if the polling wait time expires (max 20sec)
  - helps **reduce the cost** by eliminating the number of empty responses and false empty responses
  - best suitable, if the new messages that are being added to the SQS queue arrive less frequently

- **VisibilityTimeout** :
  - Period of time SQS **prevents other consumers from receiving** and processing the message which was already processed, (avoid duplicate processing)
  - **Increase VisibilityTimeout (****ChangeMessageVisibility**)**to reduce duplicate msgs being processed**
  - Default is 30sec, min=0sec , max=12hrs
  - Used when your application takes a long time to process and delete ( **DeleteMessage** ) a message from the SQS queue
- **Delay Queues:**
  - Postpone the **delivery of new messages to a queue** for a number of seconds
  - Your consumer application needs additional time to process messages
- **VisibilityTimeout** Vs. **Delay Queues**
  - **VisibilityTimeout :** message is consumed once and then timeout is set for other consumers
  - **Delay Queues :** Message itself it delayed to be processed by any consumer for first time itself
- **Dead Letter Queue:**
  - Special queue for messages that can&#39;t be processed (consumed) successfully
  - Helps in debugging your application or messaging system
- **MessageGroupIds**
  - To **process** messages **one by one, in a strict order****  **(in particular messagegroup)

## ECS - Elastic Container Service

- **ECS tasks can also be assigned with IAM ROLES** just like IAM Role or EC2 instances
- **Task definitions**
  - Container information for your application
    - Docker image to use with each container , Docker networking mode
    - CPU and memory to use with each task
    - The IAM role that your tasks should use
    - The launch type to use (EC2 or Fargate)
    - The logging configuration,
    - what to do in case of failures
    - The command the container should run when it is started
    - Any data volumes that should be used with the containers in the task
- **ECS Task placement**
  - **Task placement strategies**
    - **Algorithm for selecting instances** for task placement or tasks for termination.
    - _ **binpack** _
      - **minimizes the number of instances** in use
      - Place tasks based on the **least available amount of CPU or memory**
    - _ **random** _
      - **randomly** place the tasks
    - _ **spread** _
      - Place tasks **evenly based on the specified value** (instanceId)
  - **Task placement constraints**
    - **Rule** that is considered during task placement.
    - Ex: place tasks **based on Availability Zone** or **instance type**
    - _distinctInstance_
      - _Place each task on a different container instance_
    - _memberOf_
      - _based on expression_
    - **Task groups:** set of related tasks
  - **Cluster query language**
    - **Expressions** that enable you to **group objects**
    - you can **group container instances by Availability Zone, Instance type, or custom metadata**
  - **Task placement** constraints **place** the tasks, but _ **Cluster query language** _ is the one which provides you with _ **expression** _ to group the task
  - Task placement strategies and constraints are usually used together
  - Task placement strategies and constraints are **NOT supported for tasks using the Fargate launch type**.
  - **Fargate tasks are spread across Availability Zones**
  - [https://docs.aws.amazon.com/AmazonECS/latest/developerguide/task-placement-strategies.html](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/task-placement-strategies.html)
-
- group container instances by a specific attribute? P4Q5 Jon

- ECS Deployment types
  - Rolling update
  - Blue/Green deployment with CodeDeploy
  - External Deployment

## AWS Elastic Beanstalk

- Source bundle:
  - Consist of a **single ZIP file or WAR file** (you can include multiple WAR files inside your ZIP file)
  - **Not exceed 512 MB**
  - **Not include a parent folder or top-level directory** (subdirectories are fine)
- **cron.yaml** : is used when you deploy a **worker application** that processes **periodic background tasks**
- **.ebextensions**
  - Configuration files with a **.config file extension are placed in a folder named .ebextensions**
- Deployment Policies
  - **All at once** :
    - **Fastest** deployment
    - **No additional Cost**
    - **Complete outage , Needs downtime, all instances are taken down**
    - Deploys the new version to **all instances simultaneously**
  - **Rolling:**
    - Update a few instances at a time (batch), and then move onto the next batch once the first batch is healthy
    - Each batch is taken out of service during the deployment phase
    - **No additional Cost**
    - Reduced capacity of instance which impacts application performance
  - **Rolling with Additional batch**
    - Additional new batch/set of instance are created, version deployed in stages
  - **Immutable** :
    - Total deployment of **new instances**
    - **Higher cost** , because you bring up equal number of new instances
  - [https://blog.shikisoft.com/which\_elastic\_beanstalk\_deployment\_should\_you\_use/](https://blog.shikisoft.com/which_elastic_beanstalk_deployment_should_you_use/)
  - [https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/using-features.deploy-existing-version.html#deployments-scenarios](https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/using-features.deploy-existing-version.html#deployments-scenarios)
  - [https://jayendrapatil.com/aws-elastic-beanstalk-deployment-strategies/](https://jayendrapatil.com/aws-elastic-beanstalk-deployment-strategies/)
  - ![](RackMultipart20210625-4-1w6fu06_html_752a966f701e0548.png)

- **Worker environment**
  - when **operations or workflows that take a long time to complete**
  - Long-running task such as processing images or videos, sending email, or generating a ZIP archive use worker environment in EB
  - Can be clubbed with SQS

- AWS CLI deployment P3Q46 Jon

## DynamoDB

- [https://aws.amazon.com/blogs/database/choosing-the-right-dynamodb-partition-key/](https://aws.amazon.com/blogs/database/choosing-the-right-dynamodb-partition-key/)
- **Partition key** : Unique identifier, A simple primary key,
- **Composite primary key** _=_ **Partition key and sort key**
- Recommendations for partition keys
- **Use high-cardinality attributes**. These are attributes that have distinct values for each item,
  - _e-mailid, employee\_no, customerid, sessionid, orderid_, and so on.
- Use composite attributes. Try to combine more than one attribute to form a unique key, if that meets your access pattern
- Can **save session state** of the users (but it has **higher latency then Elasticache** )
- Session state with low latency then go for Elasticache and not DynamoDB
- RCU WCU – how to calculate ? : [https://digitalcloud.training/certification-training/aws-developer-associate/aws-database/amazon-dynamodb/](https://digitalcloud.training/certification-training/aws-developer-associate/aws-database/amazon-dynamodb/)
- Read Capacity Unit – RCU
  - **4KB** item , **1RCU** can perform **1 strongly consistent** read/sec
  - **4KB** item, **1RCU** can perform **2 eventually consistent** read/sec
  - _Transactional_ reads: 4KB item , 2RCU can perform 1 read/sec
  - Ex: **4KB item and 10RCU** , can perform 10\*1= **10 strong consistent** and 10\*2= **20 eventual consistent reads** and 5 _Transactional_ reads
- Write Capacity Unit – WCU
  - **1KB** item , **1WCU** can perform **1 standard consistent** write/sec
  - _Transactional_ write: 1KB item , 2WCU can perform 1 write/sec
  - Ex: **1KB item and 10WCU ,** Can perform 10 standard consistent writes/sec
- DynamoDB **Streams** :
  - To keep **records of changes to items in a DynamoDB** table
  - DynamoDB Streams can also be used as trigger which **can automatically trigger notification to lambda to send mails, notifications** when data change occurs in table (no need of CloudWatch integration)
  - _ **StreamViewType** _ are:
    - _ **KEYS\_ONLY** _ - Only the key attributes of the modified item are written to the stream.
    - _ **NEW\_IMAGE** _ - The entire item, as it appears **after it was modified** , is written to the stream.
    - _ **OLD\_IMAGE** _ - The entire item, as it appeared **before it was modified** , is written to the stream.
    - _ **NEW\_AND\_OLD\_IMAGES** _ - **Both the new and the old item** images of the item are written to the stream.
- Scan and Query
  - Scan queries entire table, use query instead of scans
  - For **Better performance** of (or **reduce impact** on) provisioned throughput, or reduce impact on
    - **Use query**
    - **Reduce page size**
    - **Isolate scan operations**
  - **Faster scan** results, but will place more burden on the table&#39;s provisioned throughput ( to **reduce the burden**** apply rate limiting**)
    - **parallel Scan (better used in below scenarios)**
      - The table size is 20 GB or larger
      - The table&#39;s provisioned read throughput is not being fully used.
      - Sequential Scan operations are too slow.
- **Projection expression** : returns **attributes ( Ref. table headers)**
- **Filter expressions** : return **items (actual values )** for your query
  - Attributes
-   **Cache-Control: max-age=0**
  - Invalidate cache and pull the data from DynamoDB directly
- **Time To Live (TTL)**
  - Enable TTL to **automatically clear session data or stale data in dynamoDB**
  - To clear Ex: session data, event logs, usage patterns, userlogins
- **Global secondary index**
  - Perform fast queries on specific columns in a table
  - **Speed up queries**** on ****non-key attributes use a GSI**
  - **Improve query performance and reduce costs**
  - An index with a **partition key and a sort key that can be different** from those on the base table
- **Local secondary index**
  - Perform fast queries on specific columns in a table
  - An index that has the **same partition key as the base table, but a different sort key**
- **DynamoDB write operations:**
  - To create, update, or delete an item in a DynamoDB table, use one of the following operations:
    - _PutItem_
    - _UpdateItem_
    - _DeleteItem_
  - To return the number of write capacity units consumed by any of these operations, set the _ **ReturnConsumedCapacity** _ parameter to one of the following
    - _ **TOTAL** _: returns the **total number of WCU consumed**.
    - _ **INDEXES** _: returns the **total number of WCU consumed** , with **subtotals for the table** and any **secondary indexes that were affected by the operation**.
    - _NONE_: no write capacity details are returned. (This is the default.)
- **Automic\_counters P3Q63 Jon**
- **Condtional\_writes**

- _ **ProvisionedThroughputExceeded** _ you can avoid this error by
  - Reduce page size
  - Isolate scan operations
  - **Error Retries and Exponential Backoff**

## DynamoDB Accelerator (DAX)

- In-memory caching system used inform of DynamoDB
- **performance improvement**** from milliseconds to microseconds** for DynamoDB

## API Gateway

- **HTTP 504 status code :** integration request takes longer than your API Gateway REST API maximum integration timeout parameter
- **Stage Variable**
  - Configure HTTP endpoint for your stages talk to (dev, prod, test)
  - Stage variables are used along with lambda alias
  - Pass configuration parameters (changing values) to a Lambda from API Gateway
  - API Gateway ==== pass parameters ( use **stage variable** )====\&gt; Lambda
  - Ex: You may want to **re-use the same Lambda function** for multiple stages in your API, **but the function should read data from a different Amazon DynamoDB table**** depending on which stage is being called**
- **API Integration**
  - You choose an API integration type **according to the types of integration endpoint**
  - **Lambda Function**
    - LAMBDA\_PROXY (AWS\_PROXY)
      - Simple, If your API **does not require content encoding or caching** ,
      - flexible, versatile, and streamlined integration setup
    - LAMBDA\_CUSTOM (non-proxy)
      - lambda\_proxy + how the incoming request data is mapped to the integration + resulting integration response data is mapped to the method response
  - **HTTP**
    - HTTP (HTTP Custom)
    - HTTP PROXY
  - Mock : used for testing/simulations no real backend
  - **AWS Service (only non-proxy)**
  - VPC Link
- **Mapping Templates :**
  - Script written in VTL (Velocity Template Language)
  - Convert from json to XML (one form to another)

## RDS

- RDS is not a key/value store
- You can enable **Slow query logs** to troubleshoot SQL logs within RDS

## ElastiCache

- In-memory caching system , memcached and redis
- When to choose what ?

| **Memcached** | **Redis** |
| --- | --- |
| **simplest model** possible | **Snapshots**  **, automatic failover, backup/restore** |
| **Multi-threaded** : Run large nodes with multiple cores or threads | **Replication** |
| ability to **scale in and out** | **Geospatial support** |
| **adding and removing nodes as demand** | Complex data structures: sorted sets and lists, Transactions |
| **cache objects** | Pub/Sub |
|   | Lua scripting |
|
 | Highly available then Memcached |

- **Caching strategies (Memcached)**
  - Add **Time to live (TTL) to avoid stale data or cache churn** Check question 21 of Jon Bonso practice test 1

| **Lazy loading** | **Write-through** | **Adding TTL** |
| --- | --- | --- |
| **Load cache only when required** **(Cache Miss occurs)** | **adds/updates data in the cache whenever data is written to the database**. | Integer value in sec that specifies until the key expires |
| **Only requested data is cached** | all the data is cached |   |
| lazy loading **avoids filling up the cache with data that isn&#39;t requested** | **Cache churn** : Most data is never read, which is a waste of resources. | **Add TTL to avoid cache churn** |
| Node failures aren&#39;t fatal for your application | Missing data occurs if node fails |   |
| **Stale data** | Data in the cache is never stale | **Add TTL to avoid stale data** |

## Cognito

- Must be **accessible from**  **mobile** , **desktops** , and **tablets** , and must remember user preferences across platforms
- Supports **unauthenticated access** to users
- provide the sign-up and sign-in functionality to end users with no AWS access

| **Cognito User Pool** | **Cognito Identity Pool (Federated Identities)** |
| --- | --- |
| **Authentication** | **Authorization** |
| sign-up and sign-in webpages for your app | Generate **temporary AWS credentials for unauthenticated users**. |
| Access and manage user data. | Give your users **access to AWS resources , like S3 , DynamoDB** |
| Use a custom authentication flow |   |
| Track user device, location, and IP address |   |
| adapt to sign-in requests of different risk levels |   |

- [https://aws.amazon.com/premiumsupport/knowledge-center/cognito-user-pools-identity-pools/](https://aws.amazon.com/premiumsupport/knowledge-center/cognito-user-pools-identity-pools/)
- **Cognito Sync** P4Q42 Jon
  - **Synchronize the user profile data** across mobile devices

## CodeCommit

- Access to CodeCommit
  - HTTPS Git Credentials (Generate username and pwd)
  - SSH Keys (Upload public ssh keys)

## CodeBuild

## CodePipeline

## CodeDeploy

- Can deploy software packages using an archive that has been uploaded to an Amazon S3 bucket
- Can deploy application content **from S3, GitHub, or Bitbucket**
- Can be used for deployment activities **on**** EC2, On-Prem, Lambda or ECS**
- **CodeDeploy agent**** must be installed (EC2 and On-prem ONLY) first** to use CodeDeploy
- CodeDeploy **agent is not required for Amazon ECS or AWS Lambda**
- CodeDeploy agent communicates outbound using **HTTPS over port 443**
- Deployment types
  - **In-place deployment** : on each instance in the deployment group

    - Applicable to **EC2 and On-Prem ONLY** , CANNOT be used on ~~ECS or Lambda~~

1. Application stopped
2. Latest app is installed
3. New version of the app is started and validated
- **Blue/green deployment** :

    - Applicable to **EC2 , ECS, and Lambda,** CANNOT be used on ~~ON-Prem~~

    - EC2
      - Instances in original deployment group gets **replaced** with new group of EC2 instances
    - ECS
      - **Traffic is shifted** from original tasks set to new task set
      - Load balancer are used to reroute traffic
    - Lambda
      - **Traffic is shifted** from original lambda to newer version of lambda

- AWS Lambda cannot use an in-place deployment type
- On-Prem environment cannot be used for Blue/green deployment

## CodeStar
P4Q21 Jon














## AWS Secrets Manager

- **Store secrets/credentials** and **automatically rotate them**
- Integration for Amazon RDS, Amazon Redshift, and Amazon DocumentDB

## AWS SSM Parameter

- Can **store secrets** (SecureString) but **NO automatic rotation** , you/application have to rotate if needed.

## AWS KMS keys

- Region Specific
- **Envelope Encryption** :
  - Encrypting plaintext data with a data key, and then encrypting the data key under another key
  - **master\_key( data\_key[Plaintext])** or
  - **master\_key{ data\_key (data\_key [Plaintext] ) }** and so on
  - This top-level plaintext key encryption key is known as the _ **master key** _
  - KMS helps you to encrypt this master key (plain text) and it&#39;s called customer master keys **KMS CMKs**

## CloudHSM

- You need **hardware security module** (HSM) appliance to store your encrypted keys

- **FIPS 140-2 compliance**
- Integration with applications using **PKCS#11, Java JCE, or Microsoft CNG interfaces**.
- High-performance in- **VPC cryptographic acceleration** (bulk crypto)

## CloudWatch

- **Namespaces :**
  - Metrics in different namespaces are isolated from each other
  - graphical representation of the key performance metrics for each EC2 instancce
- **Metrics**
  - CloudWatch can track custom metrics such as **memory, swap, and disk space** utilization
- **Dimensions**
- **Resolution**
- **Statistics**
- **Percentiles**
- **Alarms**
- **CloudWatch Events**
  - Respond to **state changes** in your AWS resources ( useful for triggering lambda func)
- Cloudwatch logs Vs Cloudwatch Events ? – use case example
- **HTTP 400 ThrottlingException** for PutMetricData API calls in CloudWatch
  - **Retry your call with exponential backoff and jitter**.
  - Distribute your API calls evenly over time rather than making several API calls in a short time span
  - Combine as many metrics as possible into a single API call.
  - [https://aws.amazon.com/premiumsupport/knowledge-center/cloudwatch-400-error-throttling/](https://aws.amazon.com/premiumsupport/knowledge-center/cloudwatch-400-error-throttling/)

## CloudTrail

- **Auditing** , Used for logging , continuously monitor, and retain account activity related to actions across your AWS infrastructure , ex : **API activity related to creating, modifying or deleting AWS resources**
- **event history of your AWS account activity** (console, or cli or SDK)

## AWS X-Ray

- **Tracing application activity** for **performance** of applications and operational statistics
- Analyze user requests as they **travel through your Amazon API Gateway APIs** to the underlying services
- **Log all API calls to your AWS resources**
- Useful for **governance, compliance, operational auditing,** and **risk auditing**
- **Segments** : The **data** , like the hostname, alias , IP, start and end times, subsegments , status
- **Subsegments** : **more granular details of segments.**
- **Filter expressions** : find **traces related to specific paths or users**.
- **Annotations** : key-value pair, Indexed, and **used along with Filter expressions**
- **Metadata** : key value pair, NOT indexed, used for record data you want to store in the trace but don&#39;t need to use for searching traces
- Listens for traffic on **UDP port 2000**
- **Errors** : Client errors **(400 series errors)**
- **Faults** : Server faults ( **500 series errors** )
- **Throttle** : Throttling errors ( **429 Too Many Requests** )

- [https://docs.aws.amazon.com/xray/latest/devguide/xray-concepts.html](https://docs.aws.amazon.com/xray/latest/devguide/xray-concepts.html)
- AWS IAM is used to grant X-Ray permissions to users and compute resources in your account
  - **AWSXrayReadOnlyAccess :** Access to X-Ray Console,view service maps and segments
  - **AWSXRayDaemonWriteAccess :** upload traces, and some read permissions to support the use of sampling rules
  - **AWSXrayFullAccess: Encryption key** settings and **sampling rules**
- X-ray Managed policies P4Q23 jon
- **DOES NOT** track ~~**memory, swap, and disk space**~~ use CloudWatch for such custom metrics

## Kinesis Streams

- Single KCL worker can handle any number of shards
- Number of KCL workers = \&lt; Num. of shards
- When question is about maximum KCL workers then = num. of shards (1:1 ratio)
- by **default** data records are **only accessible for 24 hours** , can be changed to max of 8760 hrs (365days)

## Links

- [https://jayendrapatil.com/aws-certified-developer-associate-june-2018-exam-learning-path/](https://jayendrapatil.com/aws-certified-developer-associate-june-2018-exam-learning-path/)
- Special Thanks to developers of [https://word2md.com](https://word2md.com/) for helping with easy conversation .docx to .md
- [https://aws.amazon.com/blogs/database/choosing-the-right-dynamodb-partition-key/](https://aws.amazon.com/blogs/database/choosing-the-right-dynamodb-partition-key/)
